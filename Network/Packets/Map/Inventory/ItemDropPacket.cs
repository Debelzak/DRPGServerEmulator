using DRPGServer.Game.Data.Models;
using DRPGServer.Network.Enum.Map;

namespace DRPGServer.Network.Packets.Map
{
    public class ItemDropPacket(ItemDrop drop, bool isDelete = false) : OutPacket((ushort)PACKET_ID.MAP_ITEM_DROP)
    {
        protected override void Serialize()
        {
            if (isDelete)
            {
                WriteEmpty();
                return;
            }
            
            WriteUInt(drop.UID);
            WriteUInt(drop.ItemID); // ItemID
            WriteBytes([
                0x05, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,   0xE7, 0x03, 0x00, 0x00, 0xE8, 0x03, 0x00, 0x00,
                0x64, 0x00, 0x00, 0x00, 0x10, 0x27, 0x00, 0x00,   0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x0F, 0x27, 0x00, 0x7D, 0x40, 0x42, 0x0F, 0x00,   0x01, 0x01, 0x00, 0x01, 0xE5, 0x2A, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00
            ]);
            WriteShort(drop.PosX); //PositionX
            WriteShort(drop.PosY); //PositionY
        }

        private void WriteEmpty()
        {
            WriteBytes(new byte[108]);
            WriteShort(drop.PosX); 
            WriteShort(drop.PosY);
        }
    }
}